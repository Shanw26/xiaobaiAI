# 小白AI 更新日志

## v2.9.3 (2026-01-07)

### 🐛 Bug 修复

**云端存储完整性修复** 💾
- ✅ **修复思考过程未保存**：AI 回复的思考过程现在会正确保存到云端数据库
- ✅ **增强消息更新功能**：`updateMessage` 函数支持同时更新 `content` 和 `thinking` 字段
- ✅ **数据完整性**：确保用户消息和 AI 消息的所有字段都完整存储到云端

### 🔧 技术改进

**cloudService.js 优化**
- 修改 `updateMessage` 函数签名：从 `(conversationId, messageId, content)` 改为 `(conversationId, messageId, updates)`
- 支持对象参数，可选择性更新 `content` 和 `thinking` 字段
- 更新数据前检查字段是否存在，避免覆盖已有数据

**App.jsx 优化**
- AI 回复完成后同时更新 `content` 和 `thinking` 到云端
- 确保思考过程在页面刷新后依然可见

### 📝 数据流说明

**用户消息存储**：
1. 本地创建消息对象（role: user, content, files）
2. 保存到云端 `messages` 表
3. ✅ 完整存储

**AI 消息存储**：
1. 本地创建空消息占位符（role: assistant, content: ''）
2. 保存到云端（占位符）
3. 获取 AI 回复后，**同时更新 content 和 thinking 到云端**
4. ✅ 完整存储（包含思考过程）

---

## v2.9.2 (2026-01-07)

### 🎯 优化

**系统集成 Claude Code 最佳实践** 📝
- ✅ **系统提示词增强**：集成 Claude Code 的工作原则到小白AI
- ✅ **诚实优先**：AI 不知道就说不知道，不确定时明确说明
- ✅ **工具使用策略**：必须调用工具，确保文件真实创建成功
- ✅ **用户体验优先**：简洁沟通，主动确认，文件路径用反引号包裹
- ✅ **任务管理**：专注当前任务，快速迭代，完成比完美更重要

**思考过程展示优化** 🤔
- ✅ **实时显示**：在流式响应中实时提取并显示思考过程
- ✅ **同步展示**：思考过程和回答内容同步显示，互不干扰
- ✅ **可折叠设计**：点击标题可展开/收起思考内容

**等待指示器优化** ⏱️
- ✅ **立即响应**：提交问题后立即显示等待指示器（0秒延迟）
- ✅ **动态提示**：根据任务时长自动更新提示文字
- ✅ **友好体验**：动画 + 文字组合，清晰反馈状态

**文件操作路径优化** 📁
- ✅ **移除默认工作目录**：不再使用固定的 `~/Downloads/小白AI工作目录`
- ✅ **强制绝对路径**：所有文件操作必须使用绝对路径（以 `/` 或 `~/` 开头）
- ✅ **文件路径绿色下划线**：被反引号包裹的路径显示为可点击的绿色下划线
- ✅ **点击打开文件**：点击绿色路径可直接在系统默认应用中打开

**语法错误修复** 🔧
- ✅ **修复模板字符串错误**：修复系统提示词中的未转义反引号导致的 ReferenceError
- ✅ **反引号转义**：所有示例路径中的反引号正确转义为 `` \` ``

### 🎨 界面更新

- 思考过程组件使用可折叠设计，默认展开
- 等待指示器使用圆点动画 + 文字提示
- 文件路径使用绿色下划线，hover 时显示"点击打开"提示

### 🔧 技术细节

**App.jsx 修改**
- 新增 `extractThinkingAndContent()` 函数实时提取思考过程
- 修改等待指示器触发时间为 0 秒
- 流式响应中同时更新 thinking 和 content 字段

**agent.js 修改**
- 移除默认工作目录（workDirectory 设为 null）
- 所有文件操作工具要求绝对路径
- 系统提示词增加 Claude Code 最佳实践
- 工具返回消息使用格式：`✅ 文件已创建：\`${filePath}\``

**MarkdownRenderer.jsx 优化**
- 简化文件路径正则表达式，不验证路径是否存在
- 使用 React.memo 优化 FilePathLink 组件，避免重新渲染
- 移除路径验证逻辑，直接显示绿色下划线
- 点击路径调用 `window.electronAPI.openPath()` 打开

### 📝 使用示例

**文件路径显示**
```
AI: ✅ 文件已创建：`/Users/shawn/Downloads/小白AI/README.md`
    [路径显示为绿色下划线，点击可打开]
```

**思考过程展示**
```
🤔 思考过程
├─ 分析：用户需求分析
├─ 方案：解决方法
├─ 注意：关键风险
└─ 预期：预期结果

[AI 回复内容...]
```

---

## v2.3.0 (2026-01-06)

### ✨ 新功能
- **在线自动更新系统**：支持自动检测和下载新版本
- **智能更新检测**：启动时自动检测 + 每24小时后台检测
- **两种更新模式**：
  - 普通更新：可选下载，用户确认后安装
  - 强制更新：自动下载，必须更新才能使用
- **更新提醒**：设置"关于"页面显示新版本徽章 🔔
- **手动检查更新**：用户可随时手动检查更新

### 🎨 界面更新
- **普通更新弹窗**：显示版本号、更新内容、下载进度
- **强制更新弹窗**：全屏遮罩，不可关闭，自动倒计时安装
- **设置页面更新**：
  - "关于"导航项显示更新徽章
  - 新版本提醒横幅
  - "立即更新"按钮
  - "检查更新"按钮

### 🔧 技术改进
- 新增 electron-updater 依赖
- 实现完整的后端更新逻辑（main.js）
- 添加更新事件监听和IPC通信
- 防止系统休眠功能（下载时）
- 实时下载进度显示
- Release 标题识别强制更新标记

### 📝 更新机制
- 通过 GitHub Release 标题判断更新类型
- 普通更新：标题如 `v2.4.0`
- 强制更新：标题包含 `[强制]` 或 `[force]`，如 `v2.4.0 [强制]`
- 自动下载安装流程
- 用户友好的进度提示

---

## v2.2.0 (2026-01-06)

### ✨ 新功能
- **后台管理系统**：添加完整的后台管理界面
- **数据统计**：用户数量、游客数量、总请求数、今日请求数
- **用户列表**：查看所有注册用户信息
- **用户详情**：查看单个用户的详细信息和API Key
- **7天趋势图**：最近7天的请求趋势可视化

### 🎨 界面更新
- 后台管理面板：左侧导航 + 右侧内容布局
- 数据统计卡片：渐变背景 + hover 效果
- 趋势图表：可视化展示最近7天请求数据
- 用户表格：清晰展示用户列表和操作按钮

### 🔧 技术改进
- 新增后台管理 API（admin-get-users、admin-get-stats、admin-get-user-detail）
- 新增 AdminPanel 组件（React）
- 新增 AdminPanel.css 样式文件
- Header 组件新增后台管理入口按钮

### 📝 数据管理
- 用户数据自动存储到 SQLite 数据库
- 请求日志自动记录（request_logs 表）
- 支持查看用户使用统计和详情

---

## v2.1.1 (2026-01-06)

### 🎯 优化
- ✨ **游客模式体验优化**：游客模式下不再提示用户输入API Key，直接使用官方Key
- 🔧 **配置更新**：默认使用智谱GLM-4.5 Flash模型

### 🐛 Bug 修复
- 修复游客模式下自动弹出设置窗口的问题

---

## v2.1.0 (2026-01-06)

### ✨ 新功能
- **用户系统**：游客模式 + 手机号登录
- **SQLite 数据库**：本地数据存储（用户、使用记录、验证码）
- **官方API Key支持**：游客前10次免费使用

### 🎨 界面更新
- 登录弹窗：手机号 + 验证码登录
- 游客限制提示：10次后提示登录
- 游客状态显示：底部显示剩余次数

### 🔧 技术改进
- 集成 better-sqlite3 数据库
- 添加用户系统 IPC API
- 优化首次启动流程

---

## v1.8.2 (2026-01-06)

### 🎨 界面优化

**设置页面重构** 📋
- ✅ **左侧分类导航**：改为左侧边栏 + 右侧内容的布局
- ✅ **三大分类**：基础配置、高级功能、关于
- ✅ **滑动效果**：切换分类时带平滑动画
- ✅ **更好的扩展性**：为未来更多设置项提供良好基础

**设置页面优化细节**
- 左侧边栏：200px 宽度，深色背景
- 导航图标：每个分类带 emoji 图标
- 激活状态：主题色背景 + 白色文字
- 内容动画：从右侧滑入效果（translateX + opacity）
- 固定标题栏：设置标题 + 关闭按钮

### 🐛 Bug 修复

**对话记录保存** 💾
- ✅ **修复保存问题**：AI 回复完成后自动保存完整对话
- ✅ **防止丢失**：确保最后一条记录正确写入文件
- ✅ **流式响应支持**：在流式输出结束后保存最终内容

**问题原因**
- 流式响应只更新了 state，没有保存到文件
- 现在在 AI 回复完成后调用 saveConversations 确保持久化

### 🔧 技术细节

**SettingsModal 组件重构**
- 新增 SETTINGS_CATEGORIES 常量定义分类
- 分离渲染函数：renderBasicSettings, renderAdvancedSettings, renderAbout
- activeCategory 状态管理当前选中分类
- 新增 CSS 样式：settings-sidebar, settings-nav-item, settings-main

**对话保存逻辑优化**
- 在 result.success 分支增加 saveConversations 调用
- 使用 setConversations 的回调形式确保获取最新状态
- 保持流式更新的同时确保数据持久化

### 📝 界面改进

- 设置弹窗宽度增加到 900px
- 左侧导航带 hover 效果
- 分类切换时内容从右侧滑入（0.3s 动画）
- 优化按钮和输入框样式保持一致

---

## v1.8.1 (2026-01-06)

### 🎨 体验优化

**1. 思考过程更详细** 🤔
- ✅ **分阶段展示**：清晰显示3个思考阶段
  - 🔍 分析需求阶段
  - 📚 检索知识阶段
  - 💡 生成回复阶段
- ✅ **详细步骤说明**：每个阶段列出具体操作步骤
- ✅ **时间戳显示**：显示完成时间，让用户了解响应速度

**2. 窗口可拖动** 🖱️
- ✅ **拖动区域**：顶部标题栏可以拖动窗口
- ✅ **智能禁用**：按钮和文字区域自动禁用拖动，方便点击
- ✅ **用户友好**：`-webkit-app-region` 实现，体验流畅

**3. Token 消耗统计** 📊
- ✅ **累计使用量**：显示总 Token 使用量（大数显示为"万"）
- ✅ **累计请求次数**：显示总对话次数
- ✅ **今日使用量**：显示当天的 Token 消耗
- ✅ **卡片式设计**：3个统计卡片，hover 时有高亮效果

### 🔧 技术细节

**思考过程优化**
- 添加详细的多阶段思考文本
- 每个阶段3个具体步骤
- 格式化输出（使用 ** 和 •）

**窗口拖动实现**
- Header CSS: `-webkit-app-region: drag`
- 按钮/文字区域: `-webkit-app-region: no-drag`
- user-select: none 防止文本选中

**Token 统计功能**
- 新增 `get-token-usage` IPC handler
- 新增 `saveTokenUsage()` 函数
- Token 数据保存到 `userData/token-usage.json`
- 记录每日使用情况，保留最近30天

### 📝 界面改进

- Token 统计使用卡片式布局
- 数字格式化显示（超过1万显示为"x.x万"）
- hover 效果增强交互反馈
- 加载状态提示

---

## v1.8.0 (2026-01-06)

### ✨ 重大功能更新

**1. 全系统权限解放** 🔓
- ✅ **移除工作目录限制**：现在可以操作任意位置的文件和文件夹
- ✅ **删除文件夹**：支持删除整个文件夹（递归删除）
- ✅ **终端命令执行**：新增强大的终端命令执行能力
- ⚠️ **注意**：这些功能非常强大，请谨慎使用

**2. 截图功能全面升级** 📸
- ✅ **区域选择**：用户可以选择截图范围，不再是全屏截图
- ✅ **预览确认**：截图后显示预览，可以确认或取消
- ✅ **标注功能**：支持在截图上画框标注重点
- ✅ **交互优化**：使用 macOS 原生截图界面，体验更流畅

### 🚀 终端命令功能

**功能说明**
小白AI 现在可以执行各种终端命令，大大扩展了能力范围。

**使用场景**
- 系统管理：查找、移动、删除文件
- 执行脚本：运行 shell 脚本或程序
- 查看信息：系统信息、进程列表、网络状态
- 开发工具：git、npm、docker 等命令

**示例命令**
```bash
# macOS 系统示例
ls -la                    # 列出文件详情
find . -name "*.txt"      # 查找文件
ps aux                    # 查看进程
du -sh *                  # 查看目录大小
```

### 📸 截图功能升级

**新的截图流程**
1. 点击截图按钮
2. 小白AI自动最小化
3. 使用系统原生截图工具选择区域
4. 截图完成后自动恢复
5. 显示预览窗口
6. 可在截图上画框标注重点
7. 确认或取消发送

**标注功能**
- 在截图上拖拽鼠标画红色框
- 支持多个标注框
- 可以清除所有标注重新标注
- 标注后的截图文件名会标注"(已标注)"

### 🔧 技术细节

**文件操作优化**
- 移除 `delete_file` 的安全路径检查
- 支持 `fs.rm()` 递归删除文件夹
- 可删除任意位置的文件和文件夹

**终端命令实现**
- 新增 `execute_command` 工具
- 使用 `child_process.exec` 执行命令
- 超时保护：默认 30 秒
- 缓冲区大小：10MB
- 支持自定义工作目录

**截图功能重构**
- macOS: `screencapture -i -r` 交互式截图
- 创建 `ScreenshotPreview` 组件
- Canvas 绘制标注框
- 预览窗口支持取消和确认

### 📝 新增文件

- `src/components/ScreenshotPreview.jsx` - 截图预览组件
- `src/components/ScreenshotPreview.css` - 预览组件样式

### ⚠️ 安全提示

这些新功能非常强大，但也需要谨慎使用：
- ✅ 可随意操作系统文件
- ✅ 可执行任意终端命令
- ⚠️ 删除操作不可逆，请确认后再执行
- ⚠️ 某些命令可能需要系统权限

---

## v1.7.2 (2026-01-06)

### 🔧 技术优化

**截图功能重构**
- ✅ **使用系统原生截图**：改用 macOS 的 `screencapture` 命令，更稳定可靠
- ✅ **移除 desktopCapturer**：不再依赖 Electron 的 desktopCapturer API
- ✅ **简化数据流**：直接返回文件路径和预览图，无需二次处理
- ✅ **跨平台支持**：macOS 已测试通过，Linux 和 Windows 预留接口

### 🎯 修复内容

**解决的问题**
- 修复 desktopCapturer 在 macOS 上需要特殊权限的问题
- 修复 "Failed to get sources" 错误
- 提升截图成功率，无需用户额外授权

### 📝 技术细节

**macOS 截图流程**
```bash
# 使用系统命令截图
screencapture -x "/tmp/screenshot-{timestamp}.png"

# -x 参数：不显示截图声音
```

**返回数据结构**
```javascript
{
  success: true,
  filePath: "/tmp/screenshot-1234567890.png",
  preview: "data:image/png;base64,..."
}
```

**平台支持**
- ✅ macOS：使用 `screencapture` 命令
- ⏳ Windows：待实现（可使用 PowerShell 截图）
- ⏳ Linux：预留 `import` 命令（需要 ImageMagick）

---

## v1.7.1 (2026-01-06)

### 🐛 Bug 修复

**截图功能优化**
- ✅ **智能窗口隐藏**：点击截图时自动最小化小白AI窗口，避免截到应用自身
- ✅ **自动恢复窗口**：截图完成后自动恢复并聚焦窗口
- ✅ **错误处理增强**：添加更详细的错误提示和异常处理
- ✅ **简化返回结构**：从 sources 数组改为直接返回 source，更简洁

### 🔧 技术细节

**截图流程优化**
1. 点击截图按钮
2. 小白AI窗口自动最小化
3. 等待 300ms 确保窗口完全隐藏
4. 调用 desktopCapturer 获取屏幕
5. 保存截图到临时目录
6. 恢复窗口并聚焦

**数据结构变化**
- 返回值：`{ success: true, source: {...} }` (之前是 sources 数组)
- 只返回主屏幕源，简化处理逻辑

### ⚠️ 使用说明

**重要**：更新此版本后需要**完全重启应用**才能使截图功能生效：
1. 关闭当前运行的小白AI（Cmd+Q 或关闭窗口）
2. 重新运行 `npm run dev`
3. 点击截图按钮测试

---

## v1.7.0 (2026-01-06)

### ✨ 新功能

**思考过程展示**
- ✅ **AI 思考可视化**：在 AI 回复前显示思考过程，让用户了解 AI 的工作流程
- ✅ **可折叠设计**：点击标题可展开/收起思考内容，不影响对话阅读
- ✅ **步骤提示**：显示分析需求、理解上下文、生成回复等关键步骤
- ✅ **友好动画**：思考过程带有箭头旋转动画，交互流畅

**截图功能**
- ✅ **一键截图**：点击截图按钮立即截取屏幕内容
- ✅ **无需上传**：截图直接保存到系统临时目录，无需手动选择文件
- ✅ **预览支持**：截图以标签形式显示，紫色边框便于区分
- ✅ **快速发送**：截图和文字消息一起发送给 AI

### 🎨 使用示例

**场景1：查看 AI 思考过程**
```
你: 帮我写一个产品文档
AI: [展开思考过程]
    🔍 分析用户需求...
    📝 理解上下文信息...
    🤔 生成回复内容...

    [收起后显示 AI 回复]
```

**场景2：截图提问**
```
1. 点击截图按钮（相机图标）
2. 截图自动保存并显示在输入框上方
3. 输入问题："这个界面有问题，帮我分析下"
4. 点击发送，AI 可以看到截图内容
```

### 🔧 技术细节

**思考过程实现**
- App.jsx：AI 消息添加 `thinking` 字段
- ChatArea.jsx：添加折叠组件，管理展开/收起状态
- ChatArea.css：思考过程样式，hover 效果和动画

**截图功能实现**
- main.js：添加 `capture-screen` 和 `save-screenshot` IPC 处理
- preload.js：暴露截图 API 到渲染进程
- InputArea.jsx：添加截图按钮和截图状态管理
- InputArea.css：截图按钮样式，截图标签紫色主题

**依赖模块**
- Electron `desktopCapturer`：屏幕捕获 API
- Electron `screen`：获取屏幕尺寸信息

### 📝 界面优化

- 截图按钮使用相机图标，直观易懂
- 截图标签使用紫色主题（#a855f7），与文件标签区分
- 思考过程默认折叠，不占用阅读空间
- 思考过程标题可点击，带 hover 效果

---

## v1.6.2 (2026-01-06)

### 🎨 界面优化

**设置弹窗美化**
- ✅ **增强遮罩效果**：背景更深（60% 黑色透明度），模糊效果提升到 8px
- ✅ **优化弹窗动画**：添加缩放效果，打开时从 0.95 缩放到 1，更流畅
- ✅ **增强标题栏**：添加底部边框，层次更分明
- ✅ **优化区域标题**：hover 时显示背景色和主题色强调条

**交互优化**
- ✅ **修复用户信息打开按钮**：修正 workDir 属性名错误（应为 workDirectory）
- ✅ **可点击提示**：hover 区域标题时显示强调条，明确告诉用户可以点击
- ✅ **视觉反馈**：标题 hover 时文字变为主题色

### 🔧 技术细节

**CSS 优化**
- 遮罩层：`background: rgba(0, 0, 0, 0.6)` + `backdrop-filter: blur(8px)`
- 弹窗动画：`transform: translateY(30px) scale(0.95)` → `translateY(0) scale(1)`
- 标题栏：添加 `border-bottom: 2px solid var(--bg-secondary)`
- 区域标题：hover 效果 + 左侧强调条动画

**Bug 修复**
- 修复用户信息打开按钮路径错误：`localConfig.workDir` → `localConfig.workDirectory`

---

## v1.6.1 (2026-01-06)

### 🎨 界面优化

**简化设置界面**
- ✅ **删除全局设置**：移除冗余的全局设置功能
- ✅ **聚焦用户信息**：用户信息移到高级功能首位
- ✅ **保留核心功能**：只保留用户信息和记忆文件
- ✅ **更清晰的层次**：设置更简洁，符合产品方法论

### 🔧 优化理由

**全局设置 vs 用户信息**
- 两者功能重叠，保留一个即可
- 用户信息更直观，通过对话自然积累
- 符合"简单"原则：降低使用门槛

**新的高级功能结构**
1. 用户信息（AI 记住的个人信息）
2. 记忆文件（AI 的对话记忆）

### 📝 使用提示

**如何让 AI 记住你的信息？**
只需在对话中自然地告诉 AI：
- "我叫晓力"
- "我是产品经理"
- "我喜欢简洁的设计"

AI 会主动询问是否保存，确认后自动记录。

---

## v1.6.0 (2026-01-06)

### ✨ 新功能

**小白AI工作目录**
- ✅ **专用工作空间**：小白AI创建的文件统一保存在工作目录中
- ✅ **默认路径**：~/Downloads/小白AI工作目录
- ✅ **集中管理**：所有AI创建的内容都在一个地方，方便查找

**用户信息记忆**
- ✅ **智能识别**：AI 可以识别你提到的个人信息
- ✅ **友好询问**：发现个人信息时，会先询问是否保存
- ✅ **个性化服务**：记住你的信息后，提供更贴心的服务
- ✅ **用户信息文件**：保存在工作目录（用户信息.md）

**记忆文件优化**
- ✅ **移至工作目录**：记忆文件从系统目录移到工作目录
- ✅ **文件名更新**：小白AI记忆.md（更清晰的命名）
- ✅ **便于查看**：用户可以直接查看和编辑记忆源文件

### 🎨 使用示例

**场景1：创建文件（未指定路径）**
```
你: 帮我创建一个待办事项列表
AI: 好的，我来创建一个待办事项列表文件。
    [文件保存到：~/Downloads/小白AI工作目录/待办事项列表.md]
```

**场景2：用户信息记忆**
```
你: 我叫晓力，是个产品经理
AI: 很高兴认识你，晓力！我发现这些是关于你的个人信息，
    要不要我帮你记下来，方便以后更好地为你服务？
你: 好的
AI: [保存用户信息]
    已记住：姓名: 晓力，职业: 产品经理
```

**场景3：查看保存的信息**
```
你: 我都告诉你哪些信息了？
AI: [调用 get_user_info 工具]
    根据我的记录：
    - 姓名: 晓力
    - 职业: 产品经理
    - ...
```

### 🔧 技术细节

**新增工具**
- `save_user_info`：保存用户信息到文件
- `get_user_info`：获取已保存的用户信息

**系统提示词优化**
- 添加用户信息管理指导
- 添加文件操作默认路径说明
- 添加产品哲学（简单、单点击穿、All-in）

**配置优化**
- 默认工作目录：~/Downloads/小白AI工作目录
- 记忆文件路径：工作目录/小白AI记忆.md
- 用户信息文件：工作目录/用户信息.md

### 📝 工作目录结构

```
~/Downloads/小白AI工作目录/
├── 小白AI记忆.md      # AI的对话记忆
├── 用户信息.md        # 你的个人信息
├── [AI创建的文件]      # 其他AI帮你创建的文件
└── ...
```

---

## v1.5.4 (2026-01-06)

### ✨ 新功能
- ✅ **删除文件功能**：AI 现在可以帮助你删除本地文件
  - 支持通过自然语言删除文件
  - 例如："删除这个文件"、"帮我删除 新年快乐2026.txt"

### 🔒 安全保护
- ✅ **安全限制**：只能删除工作目录内的文件
- ✅ **文件验证**：确保目标是文件（不是目录）
- ✅ **路径检查**：防止误删系统文件

### 🎨 使用示例
```
你: 帮我删除 下载目录/新年快乐2026.txt
AI: 好的，我来删除这个文件。
    [调用 delete_file 工具]
    文件已删除成功！
```

### 🔧 技术细节
- 新增 `delete-file` IPC handler
- 新增 `deleteFile` API（preload.js）
- 新增 `delete_file` 工具（agent.js）
- 添加路径安全检查和文件类型验证

---

## v1.5.3 (2026-01-06)

### ✨ 项目初始化
- ✅ **品牌更名**：芦笋AI → 小白AI
- ✅ **项目移动**：`/Users/xiaolin/Downloads/芦笋AI/` → `/Users/xiaolin/Downloads/小白AI/`
- ✅ **Git 仓库初始化**：首次提交到 GitHub
- ✅ **所有配置和代码已同步更新**

### 🔄 更新内容
- package.json：name 改为 `xiaobai-ai`，productName 改为 `小白AI`，appId 改为 `com.xiaobai.ai`
- 代码文件：所有品牌文案从"芦笋AI"更新为"小白AI"
- 文档：CHANGELOG.md、README.md、BUILD.md、使用指南.md 全部更新
- Git：初始化仓库，添加 .gitignore，创建首次提交

### 🔗 GitHub 仓库
- 仓库地址：https://github.com/Shanw26/xiaobaiAI
- 分支：main
- 提交：feat: 小白AI v1.5.3 初始版本

### 📝 说明
- 保留 v1.5.3 版本号不变（功能未变，仅更名和初始化 Git）

---

## v1.5.3 (2026-01-05)

### 🐛 Bug 修复
- ✅ **修复互斥折叠逻辑**：使用统一的状态管理，确保展开一个时自动折叠另一个
- ✅ **彻底解决弹窗撑开问题**：通过单一状态源管理，避免状态不同步

### 🔧 技术细节
- 重构折叠状态管理：从两个独立状态 (`isBasicExpanded`, `isAdvancedExpanded`) 改为单一状态 `expandedSection`
- 简化切换逻辑：`toggleBasicSection` 和 `toggleAdvancedSection` 更简洁可靠
- 使用字符串标识：`'basic'` | `'advanced'` | `''`（空字符串表示都折叠）

---

## v1.5.2 (2026-01-05)

### 🎨 界面优化
- ✅ **互斥折叠功能**：展开高级功能时自动折叠基础配置，反之亦然
- ✅ **基础配置可折叠**：基础配置区域也支持折叠/展开
- ✅ **弹窗高度优化**：始终保持一个区域展开，弹窗高度稳定

### 🔧 技术细节
- 新增 `isBasicExpanded` 状态控制基础配置折叠
- 新增 `toggleBasicSection` 和 `toggleAdvancedSection` 切换函数
- 实现互斥逻辑：展开一个时自动折叠另一个
- 优化 `.form-section` 样式，第一个section无边框

---

## v1.5.1 (2026-01-05)

### 🎨 界面优化
- ✅ **高级功能折叠**：默认折叠，点击"高级功能"标题展开/收起
- ✅ **优化弹窗高度**：折叠后设置弹窗更紧凑
- ✅ **修复记忆文件打开**：移除按钮禁用状态，添加友好提示
- ✅ **折叠动画**：添加箭头旋转动画和hover效果

### 🔧 技术细节
- 新增 `isAdvancedExpanded` 状态控制折叠
- 新增 `.form-section-header` 样式支持可点击标题
- 新增 `.collapse-icon` 样式和动画
- 优化记忆文件打开错误处理

---

## v1.5.0 (2026-01-05)

### ✨ 新功能
- ✅ **全局设置直接编辑**：可在弹窗中直接编写全局设置内容
- ✅ **全局设置文件上传**：支持上传文件覆盖全局设置
- ✅ **记忆文件一键打开**：点击"打开"按钮在系统文件管理器中查看记忆文件
- ✅ **简化界面文案**：移除技术性文件名，为用户做减法

### 🎨 界面优化
- ✅ 全局设置显示"已设置"而非文件路径
- ✅ 未设置时显示"直接编写"和"上传文件"两个按钮
- ✅ 已设置时显示"编辑"和"清除"按钮
- ✅ 优化编辑器弹窗高度，避免撑开

### 🔧 技术细节
- 新增编辑器模态框组件，支持 Markdown 编辑
- 新增 `openInExplorer` IPC 处理，调用系统文件管理器
- 编辑器使用等宽字体，适合代码编辑
- 编辑器最大高度限制为 50vh，可手动调整

---

## v1.1.1 (2026-01-05)

### 🎨 界面优化
- ✅ 优化输入区域上下边距（从 30px/16px 调整为 24px/24px），让视觉更对称舒适
- ✅ 增加输入区域整体空间，解决紧凑感

### 📝 技术细节
- CSS 优化：`.input-area` padding 调整为对称布局

---

## v1.1.0 (2026-01-05)

### ✨ 新功能
- ✅ **首次使用引导**：点击输入框自动弹出设置窗口（未配置 API Key 时）
- ✅ 智能提示：只会提示一次，避免重复打扰用户

### 🔧 实现细节
- 新增 `hasApiKey` 和 `onOpenSettings` props 给 InputArea 组件
- 使用 `hasPrompted` 状态标志位控制提示次数
- 自动打开设置窗口，提升首次使用体验

---

## v1.0.9 - v1.0.8 (2026-01-05)

### 🎯 样式对齐修复

#### 输入区域对齐优化 (v1.0.9)
- ✅ 修复输入框和按钮高度不一致问题
- ✅ 统一所有元素高度为 44px
- ✅ 优化 textarea 的 padding 和 line-height
- ✅ 确保所有元素使用 `box-sizing: border-box`
- ✅ 三个元素（附件按钮、输入框、发送按钮）完美对齐

#### 整体布局对齐 (v1.0.8)
- ✅ Logo 区域向下移动 10px
- ✅ Header（顶部栏）向下移动 10px
- ✅ ChatArea（对话区域）向下移动 10px
- ✅ Welcome（欢迎页面）向下移动 10px
- ✅ 所有区域与左上角 logo 完美对齐

### 📐 具体调整
- Sidebar header: `padding: 16px 12px → 26px 12px 16px`
- Header: `height: 56px → 66px`, 新增 `padding: 10px 20px`
- ChatArea: `padding: 20px → 30px 20px 20px`
- Welcome: `padding: 60px 40px → 70px 40px 60px`

---

## v1.0.7 - v1.0.5 (2026-01-05)

### 🎨 界面间距调整

#### Logo 区域优化 (v1.0.7)
- ✅ Logo 区域向下移动 10px
- ✅ Sidebar header padding: `16px → 26px`

#### 输入区域优化 (v1.0.6)
- ✅ 输入区域向下移动 10px
- ✅ InputArea padding: `14px → 30px`

#### 初始调整 (v1.0.5)
- ✅ 输入区域首次向下移动尝试
- ✅ InputArea padding: `20px → 30px`

---

## v1.0.4 - v1.0.1 (2026-01-05)

### 🔧 核心功能实现与样式修复

#### 完整 AI 功能实现 (v1.0.4)
- ✅ 集成 Claude Agent SDK
- ✅ 实现真正的 AI 调用（支持 Claude 和智谱 GLM）
- ✅ 流式响应支持（打字机效果）
- ✅ 文件操作功能
- ✅ 对话历史保存和加载
- ✅ 导出 Markdown 功能

#### HTML 结构简化 (v1.0.4)
- ✅ 移除多余的容器元素
- ✅ `attach-buttons` 和 `input-box` 容器删除
- ✅ 直接在 `input-wrapper` 中放置按钮和输入框

#### 输入区域对齐修复 (v1.0.3)
- ✅ 使用 `align-items: stretch` 确保等高
- ✅ 设置 textarea 固定高度 44px
- ✅ 优化 padding 和 line-height

#### CSS 优化 (v1.0.2)
- ✅ 修复 box-sizing 问题
- ✅ 优化对齐方式
- ✅ 统一元素高度

#### 版本号系统 (v1.0.1)
- ✅ 在左上角 logo 下方添加版本号显示
- ✅ 方便用户确认更新是否生效

---

## v1.0.0 (2026-01-05)

### 🎉 首次发布

#### 核心功能
- ✅ AI 对话功能（支持 Claude 和智谱 GLM）
- ✅ 流式响应（打字机效果）
- ✅ 文件上传和操作
- ✅ 对话历史管理（按时间分组）
- ✅ 导出对话为 Markdown
- ✅ 配置管理（API Key、模型选择、工作目录）

#### 界面特性
- ✅ 清爽的白色背景 + 绿色主题
- ✅ 左侧边栏（对话列表 + 设置）
- ✅ 响应式布局
- ✅ 自动滚动到最新消息
- ✅ 打字指示器动画

#### 技术栈
- **Electron** - 桌面应用框架
- **React** - 前端框架
- **Vite** - 构建工具
- **Claude Agent SDK** - AI 集成
- **@anthropic-ai/sdk** - Anthropic 官方 SDK

#### 项目结构
```
小白AI/
├── electron/          # Electron 主进程
│   ├── main.js       # 主进程入口（含 Agent SDK 集成）
│   ├── preload.js    # 预加载脚本
│   └── agent.js      # Agent SDK 封装
├── src/              # React 前端
│   ├── components/   # React 组件
│   ├── App.jsx       # 主应用
│   └── main.jsx      # 入口文件
├── package.json
└── vite.config.js
```

---

## 版本说明

### 版本号规则
- **主版本号.次版本号.修订号** (例如：1.1.1)
- 主版本号：重大功能更新或架构变更
- 次版本号：新功能添加
- 修订号：bug 修复和小优化

### 更新频率
- 开发期间：频繁更新（每天可能多个版本）
- 稳定版：按需更新

### 如何查看版本
- 版本号显示在左上角 logo 下方
- 每次更新后版本号自动递增
- 通过版本号确认更新是否生效

---

## 即将推出

### 计划中的功能
- [ ] 图片 OCR 功能
- [ ] 代码高亮优化
- [ ] 多语言支持
- [ ] 主题切换（深色模式）
- [ ] 快捷键支持
- [ ] 导出 PDF 功能
- [ ] 对话搜索功能
- [ ] 标签管理
- [ ] 数据统计面板

---

## 反馈与建议

如有问题或建议，欢迎反馈！
