name: Build Windows

# ğŸ¯ æ‰“åŒ…ç­–ç•¥ï¼šWindows ä½¿ç”¨ GitHub CI/CD è‡ªåŠ¨æ‰“åŒ…
# è§¦å‘æ–¹å¼ï¼š
# 1. æ¨é€ Git Tagï¼ˆå¦‚ v2.20.1ï¼‰
# 2. æ‰‹åŠ¨è§¦å‘ï¼ˆåœ¨ GitHub Actions é¡µé¢ï¼‰

on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:

jobs:
  build-windows:
    runs-on: windows-latest

    steps:
      - name: ğŸ“¥ æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: ğŸ”§ è®¾ç½® Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“¦ å®‰è£…ä¾èµ–
        run: npm install

      - name: ğŸ—ï¸ æ„å»ºå‰ç«¯
        run: npm run build

      - name: ğŸ”¨ æ‰“åŒ… Windows åº”ç”¨
        run: npx electron-builder --win --publish never

      - name: ğŸ“¤ ä¸Šä¼ å®‰è£…åŒ…
        uses: actions/upload-artifact@v4
        if: success()
        with:
          name: windows-installer
          path: release/*.exe
          retention-days: 30

      - name: ğŸ“Š æ„å»ºä¿¡æ¯
        if: success()
        run: |
          echo "âœ… Windows æ‰“åŒ…å®Œæˆï¼"
          echo "ğŸ“¦ å®‰è£…åŒ…ï¼š"
          ls -lh release/
        shell: bash

